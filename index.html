?<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏Å‡∏µ‡∏¨‡∏≤‡∏ö‡∏≤‡∏™‡πÄ‡∏Å‡πá‡∏ï‡∏ö‡∏≠‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô ‡∏Å‡∏≠‡∏á ‡∏ö‡∏ä.‡∏Å. ‡∏õ‡∏µ 2569 | Central Investigation Bureau</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700;800&display=swap" rel="stylesheet">
    <style>
        :root {
            --cib-navy: #00264d;
            --cib-gold: #ffd300;
            --cib-navy-light: #003d73;
            --cib-navy-dark: #001a36;
            --cib-gold-light: #ffdd33;
            --cib-gold-dark: #ccaa00;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Sarabun', sans-serif;
            background: linear-gradient(135deg, var(--cib-navy) 0%, var(--cib-navy-dark) 100%);
            min-height: 100vh;
            padding: 0;
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                linear-gradient(30deg, rgba(255, 211, 0, 0.05) 12%, transparent 12.5%, transparent 87%, rgba(255, 211, 0, 0.05) 87.5%);
            background-size: 80px 140px;
            z-index: 0;
            pointer-events: none;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            background: linear-gradient(135deg, var(--cib-navy) 0%, var(--cib-navy-light) 100%);
            padding: 25px 20px;
            border-radius: 20px;
            text-align: center;
            margin-bottom: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.4);
            border: 3px solid var(--cib-gold);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 211, 0, 0.1) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 0.5; }
            50% { transform: scale(1.1); opacity: 0.8; }
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        .logo-image {
            width: 120px;
            height: auto;
            margin-bottom: 15px;
            filter: drop-shadow(0 10px 30px rgba(255, 211, 0, 0.6));
            animation: logoFloat 3s ease-in-out infinite;
        }

        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .logo-badge {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--cib-gold) 0%, var(--cib-gold-light) 100%);
            border-radius: 50%;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-weight: 800;
            font-size: 2em;
            color: var(--cib-navy);
            box-shadow: 0 10px 30px rgba(255, 211, 0, 0.4);
            border: 4px solid var(--cib-navy-dark);
            margin-bottom: 20px;
        }

        .header h1 {
            color: white;
            font-size: 2em;
            font-weight: 800;
            margin-bottom: 8px;
            text-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        }

        .header .subtitle {
            color: var(--cib-gold);
            font-size: 1.1em;
            font-weight: 600;
            margin-bottom: 6px;
        }

        .header .department {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.9em;
            font-weight: 400;
        }

        .header-divider {
            width: 100px;
            height: 4px;
            background: linear-gradient(90deg, transparent, var(--cib-gold), transparent);
            margin: 15px auto;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .tab-button {
            background: white;
            border: 2px solid var(--cib-navy);
            padding: 10px 30px;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 20px rgba(0, 38, 77, 0.15);
            color: var(--cib-navy);
        }

        .tab-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 38, 77, 0.25);
            border-color: var(--cib-gold);
        }

        .tab-button.active {
            background: linear-gradient(135deg, var(--cib-navy) 0%, var(--cib-navy-light) 100%);
            color: var(--cib-gold);
            border-color: var(--cib-gold);
            box-shadow: 0 8px 30px rgba(255, 211, 0, 0.3);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .match-filters {
            background: white;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 20px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            box-shadow: 0 10px 30px rgba(0, 38, 77, 0.15);
            border: 2px solid var(--cib-gold);
        }

        .filter-group label {
            font-weight: 700;
            color: var(--cib-navy);
            font-size: 0.95em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            display: block;
            margin-bottom: 8px;
        }

        .filter-group select {
            padding: 12px 20px;
            border: 2px solid var(--cib-navy);
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            background: white;
            color: var(--cib-navy);
            transition: all 0.3s;
            min-width: 150px;
        }

        .filter-group select:hover,
        .filter-group select:focus {
            border-color: var(--cib-gold);
            box-shadow: 0 4px 12px rgba(255, 211, 0, 0.2);
            outline: none;
        }

        .matches-container {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .date-group {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0, 38, 77, 0.15);
            border-left: 6px solid var(--cib-gold);
        }

        .date-header {
            font-size: 1.2em;
            font-weight: 800;
            color: var(--cib-navy);
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--cib-gold);
        }

        .date-header::before {
            content: 'üìÖ ';
        }

        .match-card {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 10px;
            display: grid;
            grid-template-columns: 70px 1fr 140px 1fr;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
            border: 2px solid transparent;
            box-shadow: 0 4px 12px rgba(0, 38, 77, 0.08);
        }

        .match-card:hover {
            transform: translateX(8px);
            border-color: var(--cib-gold);
            box-shadow: 0 8px 25px rgba(255, 211, 0, 0.3);
        }

        .match-card.finished {
            background: linear-gradient(135deg, #e8f5e9 0%, #f1f8f4 100%);
            border-left: 4px solid #4caf50;
        }

        .match-time {
            text-align: center;
            padding: 8px 5px;
            background: var(--cib-navy);
            border-radius: 6px;
        }

        .match-time .time {
            font-size: 1.1em;
            font-weight: 700;
            color: var(--cib-gold);
        }

        .match-type {
            text-align: center;
            padding: 8px 12px;
            background: linear-gradient(135deg, var(--cib-gold) 0%, var(--cib-gold-light) 100%);
            color: var(--cib-navy);
            border-radius: 8px;
            font-weight: 800;
            font-size: 0.95em;
            box-shadow: 0 4px 12px rgba(255, 211, 0, 0.3);
        }

        .match-type.type-3x3 {
            background: linear-gradient(135deg, #10b981 0%, #34d399 100%);
            color: white;
        }

        .team-name {
            font-size: 1em;
            font-weight: 700;
            color: var(--cib-navy);
        }

        .score {
            font-size: 1.5em;
            font-weight: 800;
            color: var(--cib-navy);
            text-align: center;
            padding: 5px 10px;
            background: var(--cib-gold);
            border-radius: 6px;
            box-shadow: 0 4px 12px rgba(255, 211, 0, 0.3);
        }

        .vs {
            text-align: center;
            color: #999;
            font-weight: 700;
            font-size: 1em;
        }

        .match-group {
            text-align: center;
            padding: 8px 12px;
            background: var(--cib-navy);
            color: var(--cib-gold);
            border-radius: 8px;
            font-size: 0.9em;
            font-weight: 700;
        }

        .standings-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 30px;
        }

        .standings-card {
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 15px 50px rgba(0, 38, 77, 0.15);
            border: 3px solid var(--cib-gold);
        }

        .standings-title {
            font-size: 1.6em;
            font-weight: 800;
            color: white;
            background: linear-gradient(135deg, var(--cib-navy) 0%, var(--cib-navy-light) 100%);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 38, 77, 0.3);
        }

        .standings-title.type-3x3 {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .standings-table {
            width: 100%;
            border-collapse: collapse;
        }

        .standings-table thead {
            background: linear-gradient(135deg, var(--cib-navy) 0%, var(--cib-navy-light) 100%);
        }

        .standings-table th {
            padding: 15px 10px;
            text-align: center;
            font-weight: 700;
            color: var(--cib-gold);
            border-bottom: 3px solid var(--cib-gold);
            font-size: 0.95em;
            text-transform: uppercase;
        }

        .standings-table td {
            padding: 15px 10px;
            text-align: center;
            border-bottom: 1px solid #e0e0e0;
            font-weight: 600;
        }

        .standings-table tbody tr:hover {
            background: rgba(255, 211, 0, 0.1);
            transform: scale(1.02);
        }

        .standings-table .rank-1 {
            background: linear-gradient(135deg, #ffd700 0%, #ffed4e 100%);
            font-weight: 800;
        }

        .standings-table .rank-2 {
            background: linear-gradient(135deg, #c0c0c0 0%, #e8e8e8 100%);
            font-weight: 800;
        }

        .standings-table .rank-3 {
            background: linear-gradient(135deg, #cd7f32 0%, #e6a04d 100%);
            font-weight: 800;
            color: white;
        }

        .team-col {
            text-align: left !important;
            font-weight: 800;
            color: var(--cib-navy);
        }

        .team.winner .team-name {
            color: #2e7d32 !important; /* Green for winner */
            font-weight: 800;
        }

        .team.loser .team-name {
            color: #c62828 !important; /* Red for loser */
            opacity: 0.7;
        }

        .score.winner-score {
            background-color: #2e7d32;
            color: white;
            box-shadow: 0 4px 10px rgba(46, 125, 50, 0.3);
        }

        .score.loser-score {
            background-color: #ffebee;
            color: #c62828;
            border: 1px solid #ffcdd2;
        }

        .loading {
            text-align: center;
            padding: 60px;
            color: var(--cib-gold);
            font-size: 1.5em;
            font-weight: 700;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
            margin: 20px 0;
            font-weight: 600;
            border: 2px solid #ef5350;
        }

        .footer {
            margin-top: 50px;
            text-align: center;
            padding: 30px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 211, 0, 0.3);
            color: white;
        }

        .footer-logo {
            color: var(--cib-gold);
            font-weight: 800;
            font-size: 1.1em;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .match-card {
                grid-template-columns: 1fr;
                gap: 15px;
                text-align: center;
                padding: 15px;
            }
            
            .match-time {
                display: inline-block;
                margin-bottom: 10px;
            }

            .standings-container {
                grid-template-columns: 1fr;
            }

            .header h1 {
                font-size: 2em;
            }

            .logo-image {
                width: 120px;
                padding: 10px;
            }
            
            .logo-badge {
                width: 60px;
                height: 60px;
                font-size: 1.5em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <img src="https://i-pic.info/i/raw/rDGF1211589" alt="CIB Logo" class="logo-image">
                <h1>üèÄ ‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏Å‡∏µ‡∏¨‡∏≤‡∏ö‡∏≤‡∏™‡πÄ‡∏Å‡πá‡∏ï‡∏ö‡∏≠‡∏•‡∏†‡∏≤‡∏¢‡πÉ‡∏ô</h1>
                <div class="header-divider"></div>
                <div class="subtitle">‡∏Å‡∏≠‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div>
                <div class="department">Central Investigation Bureau ‚Ä¢ ‡∏õ‡∏µ 2569</div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab-button active" onclick="switchTab('schedule', this)">üìÖ ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô</button>
            <button class="tab-button" onclick="switchTab('standings', this)">üèÜ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
        </div>

        <div id="schedule" class="tab-content active">
            <div class="match-filters">
                <div class="filter-group">
                    <label>üîç ‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</label>
                    <select id="typeFilter" onchange="filterMatches()">
                        <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <option value="5x5">5 vs 5</option>
                        <option value="3x3">3 vs 3</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>üìä ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞:</label>
                    <select id="statusFilter" onchange="filterMatches()">
                        <option value="all">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
                        <option value="upcoming">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÅ‡∏Ç‡πà‡∏á</option>
                        <option value="finished">‡πÅ‡∏Ç‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß</option>
                    </select>
                </div>
            </div>
            <div class="matches-container" id="matchesContainer">
                <div class="loading">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
            </div>
        </div>

        <div id="standings" class="tab-content">
            <div class="standings-container" id="standingsContainer">
                <div class="loading">‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</div>
            </div>
        </div>

        <div class="footer">
            <div class="footer-logo">‚ö° CIB Basketball Championship 2569 ‚ö°</div>
            <div>Central Investigation Bureau | ‡∏Å‡∏≠‡∏á‡∏ö‡∏±‡∏ç‡∏ä‡∏≤‡∏Å‡∏≤‡∏£‡∏ï‡∏≥‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏™‡∏ß‡∏ô‡∏Å‡∏•‡∏≤‡∏á</div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
    <script>
        const SHEET_ID = '1mxUWHA4WVTxorcDlnjo32M5bZ3AK1_aJC-q0UVd8mGI';
        const SHEET_GIDS = {
            MATCHES: '2138702001',
            STANDINGS_5X5: '1697716590',
            STANDINGS_3X3: '1459040978'
        };

        let allMatches = [];
        let standings5x5 = [];
        let standings3x3 = [];

        function getSheetURL(gid) {
            return `https://docs.google.com/spreadsheets/d/${SHEET_ID}/export?format=csv&gid=${gid}&t=${Date.now()}`;
        }

        function switchTab(tabName, btn) {
            document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-button').forEach(button => button.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            if (btn) {
                btn.classList.add('active');
            } else if (typeof event !== 'undefined' && event.target) {
                event.target.classList.add('active');
            }
        }

        async function loadData() {
            try {
                const [matchesData, standings5x5Data, standings3x3Data] = await Promise.all([
                    fetchSheetData(SHEET_GIDS.MATCHES),
                    fetchSheetData(SHEET_GIDS.STANDINGS_5X5),
                    fetchSheetData(SHEET_GIDS.STANDINGS_3X3)
                ]);

                allMatches = parseMatches(matchesData);
                standings5x5 = parseStandings(standings5x5Data);
                standings3x3 = parseStandings(standings3x3Data);
                
                renderMatches();
                renderStandings();
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('matchesContainer').innerHTML = 
                    '<div class="error">‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';
                document.getElementById('standingsContainer').innerHTML = 
                    '<div class="error">‚ö†Ô∏è ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';
            }
        }

        async function fetchSheetData(gid) {
            const response = await fetch(getSheetURL(gid));
            if (!response.ok) {
                throw new Error(`Failed to fetch sheet (GID: ${gid}): ${response.status} ${response.statusText}`);
            }
            let csvText = await response.text();
            
            // Remove empty starting lines (e.g. lines with only commas)
            csvText = csvText.replace(/^([, \t]*\r?\n)+/, '');

            return new Promise((resolve, reject) => {
                Papa.parse(csvText, {
                    header: true,
                    skipEmptyLines: true,
                    complete: (results) => resolve(results.data),
                    error: (error) => reject(error)
                });
            });
        }

        function parseMatches(data) {
            return data.map(row => {
                // Try both Capitalized and lowercase keys to be safe
                const homeRaw = row['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô-Home'] !== undefined ? row['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô-Home'] : row['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô-home'];
                const awayRaw = row['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô-Away'] !== undefined ? row['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô-Away'] : row['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô-away'];
                
                const scoreHome = (homeRaw !== undefined && homeRaw !== '' && !isNaN(parseInt(homeRaw))) ? parseInt(homeRaw) : null;
                const scoreAway = (awayRaw !== undefined && awayRaw !== '' && !isNaN(parseInt(awayRaw))) ? parseInt(awayRaw) : null;
                
                return {
                    date: row['‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà'] || '',
                    time: row['‡πÄ‡∏ß‡∏•‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°'] || '',
                    type: row['‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó'] || '',
                    round: row['‡∏£‡∏≠‡∏ö'] || '',
                    home: row['Home'] || '',
                    away: row['Away'] || '',
                    matchId: row['‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô'] || '',
                    group: row['‡∏™‡∏≤‡∏¢/‡∏Å‡∏•‡∏∏‡πà‡∏°'] || '',
                    note: row['‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏'] || '',
                    scoreHome: scoreHome,
                    scoreAway: scoreAway
                };
            }).filter(match => match.home || match.away);
        }

        function parseStandings(data) {
            return data.map(row => {
                const goalsFor = parseInt(row['‡πÑ‡∏î‡πâ']) || 0;
                const goalsAgainst = parseInt(row['‡πÄ‡∏™‡∏µ‡∏¢']) || 0;
                return {
                    name: row['‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°'] || '',
                    played: parseInt(row['‡πÅ‡∏Ç‡πà‡∏á']) || 0,
                    won: parseInt(row['‡∏ä‡∏ô‡∏∞']) || 0,
                    drawn: parseInt(row['‡πÄ‡∏™‡∏°‡∏≠']) || 0,
                    lost: parseInt(row['‡πÅ‡∏û‡πâ']) || 0,
                    goalsFor: goalsFor,
                    goalsAgainst: goalsAgainst,
                    goalDiff: parseInt(row['‡∏ú‡∏•‡∏ï‡πà‡∏≤‡∏á']) || (goalsFor - goalsAgainst),
                    points: parseInt(row['‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô']) || 0
                };
            }).filter(team => team.name && team.name.trim() !== '');
        }

        // Parse Thai date for sorting
        function parseThaiDate(dateStr) {
            if (!dateStr) return new Date(0);
            const parts = dateStr.trim().split(/[\/\-\.]/);
            if (parts.length >= 2) {
                const day = parseInt(parts[0]);
                const month = parseInt(parts[1]) - 1;
                let year = parts.length === 3 ? parseInt(parts[2]) : new Date().getFullYear() + 543;
                if (year < 100) year += 2500;
                return new Date(year - 543, month, day);
            }
            return new Date(0);
        }

        function renderMatches() {
            const container = document.getElementById('matchesContainer');
            const typeFilter = document.getElementById('typeFilter').value;
            const statusFilter = document.getElementById('statusFilter').value;
            
            let filteredMatches = allMatches.filter(match => {
                const typeMatch = typeFilter === 'all' || 
                    (typeFilter === '5x5' && match.type === '5x5') ||
                    (typeFilter === '3x3' && match.type === '3x3');
                
                const hasResult = match.scoreHome !== null && match.scoreHome !== '';
                
                const statusMatch = statusFilter === 'all' ||
                    (statusFilter === 'upcoming' && !hasResult) ||
                    (statusFilter === 'finished' && hasResult);
                
                return typeMatch && statusMatch;
            });

            const grouped = {};
            filteredMatches.forEach(match => {
                if (!grouped[match.date]) grouped[match.date] = [];
                grouped[match.date].push(match);
            });

            let html = '';
            Object.keys(grouped).sort((a, b) => parseThaiDate(a) - parseThaiDate(b)).forEach(date => {
                html += `<div class="date-group"><div class="date-header">${formatThaiDate(date)}</div>`;
                
                grouped[date].forEach(match => {
                    // Check logic for scores: strict check on null, allow 0
                    const hasResult = match.scoreHome !== null && match.scoreAway !== null;
                    
                    // Determine winner/loser styles
                    let homeClass = '';
                    let awayClass = '';
                    let homeScoreClass = '';
                    let awayScoreClass = '';
                    
                    if (hasResult) {
                        if (match.scoreHome > match.scoreAway) {
                            homeClass = 'winner';
                            homeScoreClass = 'winner-score';
                            awayClass = 'loser';
                            awayScoreClass = 'loser-score';
                        } else if (match.scoreHome < match.scoreAway) {
                            homeClass = 'loser';
                            homeScoreClass = 'loser-score';
                            awayClass = 'winner';
                            awayScoreClass = 'winner-score';
                        }
                    } else {
                        // Reset classes specifically if no result
                        homeClass = '';
                        awayClass = '';
                    }

                    // Layout: Time | Team A | Score/VS | Team B
                    // Team Name: align right for home, left for away
                    html += `
                        <div class="match-card ${hasResult ? 'finished' : ''}">
                            <div class="match-time"><div class="time">${match.time || '-'}</div></div>
                            
                            <div class="team ${homeClass}" style="text-align: right;">
                                <div class="team-name">${match.home || '-'}</div>
                            </div>

                            ${hasResult 
                                ? `<div class="score-container" style="text-align: center; display: flex; justify-content: center; align-items: center; white-space: nowrap;">
                                     <span class="score ${homeScoreClass}">${match.scoreHome}</span>
                                     <span style="margin: 0 10px; color: #ccc; font-weight: bold;">-</span>
                                     <span class="score ${awayScoreClass}">${match.scoreAway}</span>
                                   </div>` 
                                : `<div class="vs" style="font-size: 1.5em; color: var(--cib-gold);">VS</div>`
                            }

                            <div class="team ${awayClass}" style="text-align: left;">
                                <div class="team-name">${match.away || '-'}</div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            });

            container.innerHTML = html || '<div class="loading">üîç ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';
        }

        function renderStandings() {
            const container = document.getElementById('standingsContainer');
            let html = '';
            
            if (standings5x5.length > 0) {
                html += `
                    <div class="standings-card">
                        <div class="standings-title">üèÄ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 5 vs 5</div>
                        <table class="standings-table">
                            <thead><tr>
                                <th>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th><th>‡∏ó‡∏µ‡∏°</th><th>‡πÅ‡∏Ç‡πà‡∏á</th><th>‡∏ä‡∏ô‡∏∞</th><th>‡πÄ‡∏™‡∏°‡∏≠</th>
                                <th>‡πÅ‡∏û‡πâ</th><th>+/-</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                            </tr></thead><tbody>`;
                
                standings5x5.sort((a, b) => b.points - a.points || (b.goalDiff - a.goalDiff))
                    .forEach((team, index) => {
                        const rankClass = index === 0 ? 'rank-1' : index === 1 ? 'rank-2' : index === 2 ? 'rank-3' : '';
                        const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '';
                        html += `
                            <tr class="${rankClass}">
                                <td>${medal} ${index + 1}</td>
                                <td class="team-col">${team.name}</td>
                                <td>${team.played}</td><td>${team.won}</td><td>${team.drawn}</td>
                                <td>${team.lost}</td>
                                <td>${team.goalDiff > 0 ? '+' : ''}${team.goalDiff}</td>
                                <td><strong>${team.points}</strong></td>
                            </tr>`;
                    });
                html += '</tbody></table></div>';
            }

            if (standings3x3.length > 0) {
                html += `
                    <div class="standings-card">
                        <div class="standings-title type-3x3">üèÄ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô 3 vs 3</div>
                        <table class="standings-table">
                            <thead><tr>
                                <th>‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö</th><th>‡∏ó‡∏µ‡∏°</th><th>‡πÅ‡∏Ç‡πà‡∏á</th><th>‡∏ä‡∏ô‡∏∞</th><th>‡πÄ‡∏™‡∏°‡∏≠</th>
                                <th>‡πÅ‡∏û‡πâ</th><th>+/-</th><th>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</th>
                            </tr></thead><tbody>`;
                
                standings3x3.sort((a, b) => b.points - a.points || (b.goalDiff - a.goalDiff))
                    .forEach((team, index) => {
                        const rankClass = index === 0 ? 'rank-1' : index === 1 ? 'rank-2' : index === 2 ? 'rank-3' : '';
                        const medal = index === 0 ? 'ü•á' : index === 1 ? 'ü•à' : index === 2 ? 'ü•â' : '';
                        html += `
                            <tr class="${rankClass}">
                                <td>${medal} ${index + 1}</td>
                                <td class="team-col">${team.name}</td>
                                <td>${team.played}</td><td>${team.won}</td><td>${team.drawn}</td>
                                <td>${team.lost}</td>
                                <td>${team.goalDiff > 0 ? '+' : ''}${team.goalDiff}</td>
                                <td><strong>${team.points}</strong></td>
                            </tr>`;
                    });
                html += '</tbody></table></div>';
            }

            container.innerHTML = html || '<div class="loading">üîç ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</div>';
        }

        function filterMatches() {
            renderMatches();
        }

        function formatThaiDate(dateStr) {
            if (!dateStr) return '';
            const months = ['‡∏°.‡∏Ñ.', '‡∏Å.‡∏û.', '‡∏°‡∏µ.‡∏Ñ.', '‡πÄ‡∏°.‡∏¢.', '‡∏û.‡∏Ñ.', '‡∏°‡∏¥.‡∏¢.', 
                          '‡∏Å.‡∏Ñ.', '‡∏™.‡∏Ñ.', '‡∏Å.‡∏¢.', '‡∏ï.‡∏Ñ.', '‡∏û.‡∏¢.', '‡∏ò.‡∏Ñ.'];
            const days = ['‡∏≠‡∏≤‡∏ó‡∏¥‡∏ï‡∏¢‡πå', '‡∏à‡∏±‡∏ô‡∏ó‡∏£‡πå', '‡∏≠‡∏±‡∏á‡∏Ñ‡∏≤‡∏£', '‡∏û‡∏∏‡∏ò', '‡∏û‡∏§‡∏´‡∏±‡∏™‡∏ö‡∏î‡∏µ', '‡∏®‡∏∏‡∏Å‡∏£‡πå', '‡πÄ‡∏™‡∏≤‡∏£‡πå'];
            const parts = dateStr.trim().split(/[\/\-\.]/);
            
            if (parts.length >= 2) {
                const day = parseInt(parts[0]);
                const month = parseInt(parts[1]) - 1;
                let year = parts.length === 3 ? parseInt(parts[2]) : new Date().getFullYear() + 543;
                if (year < 100) year += 2500;
                const date = new Date(year - 543, month, day);
                if (!isNaN(date.getTime())) {
                    return `${days[date.getDay()]}‡∏ó‡∏µ‡πà ${day} ${months[month]} ${year}`;
                }
            }
            return dateStr;
        }

        loadData();
        setInterval(loadData, 30000);
    </script>
</body>
</html>
